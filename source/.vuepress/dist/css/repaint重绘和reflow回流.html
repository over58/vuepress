<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>repaint重绘和reflow回流 | Adroi媒体API 接口文档</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="Adroi">
    <link rel="preload" href="/vuepress/assets/css/0.styles.7e3681cf.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.4c3d8c08.js" as="script"><link rel="preload" href="/vuepress/assets/js/2.504a4fb4.js" as="script"><link rel="preload" href="/vuepress/assets/js/20.6c38a1d1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.2e1f457a.js"><link rel="prefetch" href="/vuepress/assets/js/100.69be1aac.js"><link rel="prefetch" href="/vuepress/assets/js/101.f2d9c3ba.js"><link rel="prefetch" href="/vuepress/assets/js/102.dab86b6c.js"><link rel="prefetch" href="/vuepress/assets/js/103.f6d48b6b.js"><link rel="prefetch" href="/vuepress/assets/js/104.3af59700.js"><link rel="prefetch" href="/vuepress/assets/js/105.cd6dba15.js"><link rel="prefetch" href="/vuepress/assets/js/106.2780f302.js"><link rel="prefetch" href="/vuepress/assets/js/107.718538b4.js"><link rel="prefetch" href="/vuepress/assets/js/108.05c6fd5d.js"><link rel="prefetch" href="/vuepress/assets/js/109.6e4d0078.js"><link rel="prefetch" href="/vuepress/assets/js/11.0c3d3867.js"><link rel="prefetch" href="/vuepress/assets/js/110.55b2e189.js"><link rel="prefetch" href="/vuepress/assets/js/111.bbd33e6f.js"><link rel="prefetch" href="/vuepress/assets/js/112.1b1418a2.js"><link rel="prefetch" href="/vuepress/assets/js/113.5d225fe2.js"><link rel="prefetch" href="/vuepress/assets/js/114.62231e84.js"><link rel="prefetch" href="/vuepress/assets/js/115.4484de48.js"><link rel="prefetch" href="/vuepress/assets/js/116.b1161fb4.js"><link rel="prefetch" href="/vuepress/assets/js/12.05410804.js"><link rel="prefetch" href="/vuepress/assets/js/13.c257f5fd.js"><link rel="prefetch" href="/vuepress/assets/js/14.24f97a2a.js"><link rel="prefetch" href="/vuepress/assets/js/15.90d51633.js"><link rel="prefetch" href="/vuepress/assets/js/16.793ee9a7.js"><link rel="prefetch" href="/vuepress/assets/js/17.f16cfc36.js"><link rel="prefetch" href="/vuepress/assets/js/18.15a00c2c.js"><link rel="prefetch" href="/vuepress/assets/js/19.acf47267.js"><link rel="prefetch" href="/vuepress/assets/js/21.b212c78d.js"><link rel="prefetch" href="/vuepress/assets/js/22.cb7f5f64.js"><link rel="prefetch" href="/vuepress/assets/js/23.c5af75e5.js"><link rel="prefetch" href="/vuepress/assets/js/24.68de2ffd.js"><link rel="prefetch" href="/vuepress/assets/js/25.3379eb36.js"><link rel="prefetch" href="/vuepress/assets/js/26.03f0f7bd.js"><link rel="prefetch" href="/vuepress/assets/js/27.afd99cce.js"><link rel="prefetch" href="/vuepress/assets/js/28.8c827302.js"><link rel="prefetch" href="/vuepress/assets/js/29.2b03dd80.js"><link rel="prefetch" href="/vuepress/assets/js/3.b9c82753.js"><link rel="prefetch" href="/vuepress/assets/js/30.caf4564d.js"><link rel="prefetch" href="/vuepress/assets/js/31.91ada845.js"><link rel="prefetch" href="/vuepress/assets/js/32.23cb9536.js"><link rel="prefetch" href="/vuepress/assets/js/33.4124b074.js"><link rel="prefetch" href="/vuepress/assets/js/34.7fb53727.js"><link rel="prefetch" href="/vuepress/assets/js/35.4aeb595b.js"><link rel="prefetch" href="/vuepress/assets/js/36.635c9ad3.js"><link rel="prefetch" href="/vuepress/assets/js/37.869edce2.js"><link rel="prefetch" href="/vuepress/assets/js/38.009324ba.js"><link rel="prefetch" href="/vuepress/assets/js/39.fcf46ae3.js"><link rel="prefetch" href="/vuepress/assets/js/4.5ed19beb.js"><link rel="prefetch" href="/vuepress/assets/js/40.cc3106e0.js"><link rel="prefetch" href="/vuepress/assets/js/41.38da2a4a.js"><link rel="prefetch" href="/vuepress/assets/js/42.bb47998b.js"><link rel="prefetch" href="/vuepress/assets/js/43.daa8c09a.js"><link rel="prefetch" href="/vuepress/assets/js/44.ab2cb9f6.js"><link rel="prefetch" href="/vuepress/assets/js/45.ff0a2c0c.js"><link rel="prefetch" href="/vuepress/assets/js/46.65fbf932.js"><link rel="prefetch" href="/vuepress/assets/js/47.9fd2ae18.js"><link rel="prefetch" href="/vuepress/assets/js/48.0899e6ef.js"><link rel="prefetch" href="/vuepress/assets/js/49.34f98028.js"><link rel="prefetch" href="/vuepress/assets/js/5.5ec666cd.js"><link rel="prefetch" href="/vuepress/assets/js/50.f76be82b.js"><link rel="prefetch" href="/vuepress/assets/js/51.3d23a5c2.js"><link rel="prefetch" href="/vuepress/assets/js/52.7248379e.js"><link rel="prefetch" href="/vuepress/assets/js/53.de24ee86.js"><link rel="prefetch" href="/vuepress/assets/js/54.65b89acf.js"><link rel="prefetch" href="/vuepress/assets/js/55.9f39dfd4.js"><link rel="prefetch" href="/vuepress/assets/js/56.79b96bd6.js"><link rel="prefetch" href="/vuepress/assets/js/57.257943ce.js"><link rel="prefetch" href="/vuepress/assets/js/58.dbc43307.js"><link rel="prefetch" href="/vuepress/assets/js/59.ba3e78c7.js"><link rel="prefetch" href="/vuepress/assets/js/6.9c419b6f.js"><link rel="prefetch" href="/vuepress/assets/js/60.f6cb3f45.js"><link rel="prefetch" href="/vuepress/assets/js/61.8fccbe6b.js"><link rel="prefetch" href="/vuepress/assets/js/62.876ce530.js"><link rel="prefetch" href="/vuepress/assets/js/63.d09b9ba9.js"><link rel="prefetch" href="/vuepress/assets/js/64.7ae4c720.js"><link rel="prefetch" href="/vuepress/assets/js/65.dcb24d90.js"><link rel="prefetch" href="/vuepress/assets/js/66.25fee310.js"><link rel="prefetch" href="/vuepress/assets/js/67.363f95f8.js"><link rel="prefetch" href="/vuepress/assets/js/68.d10a4837.js"><link rel="prefetch" href="/vuepress/assets/js/69.dfa76a7a.js"><link rel="prefetch" href="/vuepress/assets/js/7.867b2329.js"><link rel="prefetch" href="/vuepress/assets/js/70.e232d8eb.js"><link rel="prefetch" href="/vuepress/assets/js/71.5472e87d.js"><link rel="prefetch" href="/vuepress/assets/js/72.86c24205.js"><link rel="prefetch" href="/vuepress/assets/js/73.d491d0fa.js"><link rel="prefetch" href="/vuepress/assets/js/74.b3f7f198.js"><link rel="prefetch" href="/vuepress/assets/js/75.04dec8a8.js"><link rel="prefetch" href="/vuepress/assets/js/76.3f863c0e.js"><link rel="prefetch" href="/vuepress/assets/js/77.2af4230c.js"><link rel="prefetch" href="/vuepress/assets/js/78.8e477d1e.js"><link rel="prefetch" href="/vuepress/assets/js/79.bb6d8069.js"><link rel="prefetch" href="/vuepress/assets/js/8.7d3eea64.js"><link rel="prefetch" href="/vuepress/assets/js/80.50e664bf.js"><link rel="prefetch" href="/vuepress/assets/js/81.1eb919e8.js"><link rel="prefetch" href="/vuepress/assets/js/82.23f7096a.js"><link rel="prefetch" href="/vuepress/assets/js/83.d4e00f8f.js"><link rel="prefetch" href="/vuepress/assets/js/84.161eff9e.js"><link rel="prefetch" href="/vuepress/assets/js/85.b8895c91.js"><link rel="prefetch" href="/vuepress/assets/js/86.fece9d59.js"><link rel="prefetch" href="/vuepress/assets/js/87.713e3b60.js"><link rel="prefetch" href="/vuepress/assets/js/88.d24c1bab.js"><link rel="prefetch" href="/vuepress/assets/js/89.9cfc7c2e.js"><link rel="prefetch" href="/vuepress/assets/js/9.995dc946.js"><link rel="prefetch" href="/vuepress/assets/js/90.204c89d9.js"><link rel="prefetch" href="/vuepress/assets/js/91.076ab478.js"><link rel="prefetch" href="/vuepress/assets/js/92.65e80259.js"><link rel="prefetch" href="/vuepress/assets/js/93.6cb8f216.js"><link rel="prefetch" href="/vuepress/assets/js/94.7e57d8f6.js"><link rel="prefetch" href="/vuepress/assets/js/95.c40c0fdb.js"><link rel="prefetch" href="/vuepress/assets/js/96.18c67a13.js"><link rel="prefetch" href="/vuepress/assets/js/97.2881347c.js"><link rel="prefetch" href="/vuepress/assets/js/98.e8257a88.js"><link rel="prefetch" href="/vuepress/assets/js/99.cd60c379.js">
    <link rel="stylesheet" href="/vuepress/assets/css/0.styles.7e3681cf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress/" class="home-link router-link-active"><!----> <span class="site-name">Adroi媒体API 接口文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress/apiword.html" class="nav-link">
  接口定义
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress/apiword.html" class="nav-link">
  接口定义
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>chart</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>css</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress/css/" aria-current="page" class="sidebar-link">/css/</a></li><li><a href="/vuepress/css/bfc和float.html" class="sidebar-link">bfc/float</a></li><li><a href="/vuepress/css/button-popup.html" class="sidebar-link">button-popup</a></li><li><a href="/vuepress/css/button样式的实现.html" class="sidebar-link">button样式的实现</a></li><li><a href="/vuepress/css/css各种情况下的居中.html" class="sidebar-link">css各种情况下的居中</a></li><li><a href="/vuepress/css/css实现单行、多行文本溢出.html" class="sidebar-link">css实现单行、多行文本溢出</a></li><li><a href="/vuepress/css/css知识点大全.html" class="sidebar-link">css知识点大全</a></li><li><a href="/vuepress/css/overflow-x-overflow-y一个为visible-一个为非visible时候的怪异行为.html" class="sidebar-link">overflow-x/overflow-y一个为visible,一个为非visible时候的怪异行为</a></li><li><a href="/vuepress/css/px-em-rem的区别.html" class="sidebar-link">px,em,rem的区别</a></li><li><a href="/vuepress/css/repaint重绘和reflow回流.html" class="active sidebar-link">repaint重绘和reflow回流</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress/css/visibilty、display-none的区别.html" class="sidebar-link">visibilty:hidden、display:none、opacity:0的区别</a></li><li><a href="/vuepress/css/伪类确定元素数量.html" class="sidebar-link">伪类确定元素数量</a></li><li><a href="/vuepress/css/前端性能优化之重排、重绘与合成.html" class="sidebar-link">前端性能优化之重排、重绘与合成</a></li><li><a href="/vuepress/css/双层边框样式.html" class="sidebar-link">双层边框样式</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>other</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>前言： 为什么不能用CSS通配符 *，CSS选择器层叠为什么不能超过三层，CSS为什么尽量使用类选择器，书写HTML为什么少使用table，为什么结构要尽量简单-DOM树要小….</p> <h3 id="浏览器解析大概的工作流程大致可归纳为四个步骤"><a href="#浏览器解析大概的工作流程大致可归纳为四个步骤" class="header-anchor">#</a> 浏览器解析大概的工作流程大致可归纳为四个步骤：</h3> <ol><li>解析HTML以构建DOM树：渲染引擎开始解析HTML文档，转换树中的html标签或js生成的标签到DOM节点，它被称为 – 内容树。</li> <li>构建渲染树：解析CSS（包括外部CSS文件和样式元素以及js生成的样式）成样式结构体，根据CSS选择器计算出节点的样式，创建另一个树 —- 渲染树（render tree）。 注：在解析的过程中会去掉浏览器不能识别的样式，比如IE会去掉-moz开头的样式，而firefox会去掉_开头的样式。</li> <li>布局渲染树: 从根节点递归调用，计算每一个元素的大小、位置等，给每个节点所应该出现在屏幕上的精确坐标。</li> <li>绘制渲染树: 遍历渲染树，每个节点将使用UI后端层来绘制。</li></ol> <p>比较：
render tree能识别样式，render tree中每个node都有自己的style，而且render tree不包含隐藏的节点(比如display:none的节点，还有head节点)，因为这些节点不会用于呈现，而且不会影响呈现的，所以就不会包含到 render tree中。注意 visibility:hidden隐藏的元素还是会包含到render tree中的，因为visibility:hidden 会影响布局(layout)，会占有空间。
定义
我们可以看到 Reflow 和Repaint 分别出现在了第三和第四步。因此我们给出下面的定义： 对于DOM结构中的各个元素都有自己的盒子（模型），这些都需要浏览器根据各种样式（浏览器的、开发人员定义的等）来计算并根据计算结果将元素放到它该出现的<strong>位置</strong>，这个过程称之为<strong>reflow</strong>； 当各种盒子的<strong>位置、大小以及其他属性</strong>，例如颜色、字体大小等都确定下来后，浏览器于是便把这些元素都按照各自的特性绘制了一遍，于是页面的内容出现了，这个过程称之为<strong>repaint</strong>。
回流与重绘总结：
当render tree中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为回流(reflow)。
<strong>每个页面至少需要一次回流</strong>，就是在页面第一次加载的时候。在回流的时候，浏览器会使渲染树中受到影响的部分失效，并重新构造这部分渲染树，完成回流后，浏览器会重新绘制受影响的部分到屏幕中，该过程成为重绘。 当render tree中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如background-color。则就叫称为repaint重绘。 <strong>注意：回流必将引起重绘，而重绘不一定会引起回流。 引起Repain和Reflow的一些操作 Reflow 的成本比 Repaint 的成本高得多的多</strong>。DOM Tree 里的每个结点都会有 reflow 方法，一个结点的 reflow 很有可能导致子结点，甚至父点以及同级结点的 reflow。 当你增加、删除、修改 DOM 结点时，会导致 Reflow 或 Repaint。 当你移动 DOM 的位置，或是搞个动画的时候。 当你修改 /删除CSS 样式的时候。 当你 Resize 窗口的时候（移动端没有这个问题），或是滚动的时候。 当你修改网页的默认字体时。 当你设置 style 属性的值 （Setting a property of the style attribute）。</p> <blockquote><p>注：display:none 会触发 reflow，而 visibility:hidden 只会触发 repaint，因为没有发现位置变化。</p></blockquote> <h3 id="如何减少repain和reflow-reflow是不可避免的-只能将reflow对性能的影响减到最小-给出下面几条建议"><a href="#如何减少repain和reflow-reflow是不可避免的-只能将reflow对性能的影响减到最小-给出下面几条建议" class="header-anchor">#</a> 如何减少Repain和Reflow? Reflow是不可避免的，只能将Reflow对性能的影响减到最小,给出下面几条建议：</h3> <ol><li>不要一条一条地修改 DOM 的样式。与其这样，还不如预先定义好 css 的 class，然后修改 DOM 的 className，即将多次改变样式属性的操作合并成一次操作：
// 不好的写法 var left = 10, top = 10; el.style.left = left + &quot;px&quot;; el.style.top = top + &quot;px&quot;; el.style.background = '#eee'; // 比较好的写法 el.className += &quot; theclassname&quot;;</li> <li>让要操作的元素进行”离线处理”，处理完后一起更新
使用DocumentFragment进行缓存操作,引发一次回流和重绘；
使用display:none技术，只引发两次回流和重绘;
原理：由于isplay属性为none的元素不在渲染树中，对隐藏的元素操 作不会引发其他元素的重排。如果要对一个元素进行复杂的操作时，可以先隐藏它，操作完成后再显示。这样只在隐藏和显示时触发2次重排。
使用cloneNode(true or false) 和 replaceChild 技术，引发一次回流和重绘；</li> <li>不要把 DOM 节点的属性值放在一个循环里当成循环里的变量。不然这会导致大量地读写这个结点的属性。</li> <li>尽可能的修改层级比较低的 DOM节点。当然，改变层级比较底的 DOM节点有可能会造成大面积的 reflow，但是也可能影响范围很小。 因为改变 DOM 树中的一级会导致所有层级的改变，上至根部，下至被改变节点的子节点。这导致大量时间耗费在执行 reflow 上面</li> <li>将需要多次重排的元素，position属性设为absolute或fixed，这样此元素就脱离了文档流，它的变化不会影响到其他元素为动画的 HTML 元素，例如动画，那么修改他们的 CSS 是会大大减小 reflow 。因为,   它们不影响其他元素的布局，所它他们只会导致重新绘制，而不是一个完整回流。这样消耗会更低。</li> <li>不要用tables布局的一个原因就是tables中某个元素一旦触发reflow就会导致table里所有的其它元素reflow。在适合用table的场合，可以设置table-layout为auto或fixed，这样可以让table一行一行的   渲染，这种做法也是为了限制reflow的影响范围。</li> <li>避免使用CSS的JavaScript表达式，如果css里有expression，每次都会重新计算一遍。</li></ol> <blockquote><p>来源： https://blog.csdn.net/ClaireKe/article/details/51375622</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepress/css/px-em-rem的区别.html" class="prev">
        px,em,rem的区别
      </a></span> <span class="next"><a href="/vuepress/css/visibilty、display-none的区别.html">
        visibilty:hidden、display:none、opacity:0的区别
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress/assets/js/app.4c3d8c08.js" defer></script><script src="/vuepress/assets/js/2.504a4fb4.js" defer></script><script src="/vuepress/assets/js/20.6c38a1d1.js" defer></script>
  </body>
</html>
