(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{455:function(e,n,r){"use strict";r.r(n);var t=r(42),o=Object(t.a)({},(function(){var e=this.$createElement,n=this._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[this._v("var http = require('http')\n  , exec = require('exec')\n\n\nconst PORT = process.env.PORT || 9988\n\n\nlet transporter = nodemailer.createTransport({\n  service: 'smpt.163.com',\n  host: 'smtp.163.com',\n  secureConnection: true,\n  port:    465,\n  auth: {\n    user: 'XXX@163.com',\n    pass: 'XXXXXXX'\n  }\n});\n\nlet defaultOpions = {\n  from: 'yongchao blog <XXX@163.com>',\n  to: 'XXXX@qq.com',\n  subject: 'yongchao blog',\n  html: '<b>blog deploy success !</b>'\n}\n\nvar deployServer = http.createServer(function(request, response) {\n  if (request.url.search(/deploy\\/?$/i) > 0) {\n \n    var commands = [\n      'make restart' //这是我自定义的重新部署的代码\n    ].join(' && ')\n \n    exec(commands, function(err, out, code) {\n      if (err instanceof Error) {\n        response.writeHead(500)\n        response.end('Server Internal Error.')\n        throw err\n      }\n      process.stderr.write(err)\n      process.stdout.write(out)\n      response.writeHead(200)\n      response.end('Deploy Done.')\n      transporter.sendMail(defaultOpions, (err, info) => {\n          if(err) {\n                  console.error(err)\n          }else{\n              console.log(err, info)\n          }\n      })\n    })\n \n  } else {\n \n    response.writeHead(404)\n    response.end('Not Found.')\n \n  }\n})\ndeployServer.listen(PORT, () => {\n  console.log('start service' + PORT)\n})\n\n\n")])])])])}),[],!1,null,null,null);n.default=o.exports}}]);