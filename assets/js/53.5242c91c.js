(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{356:function(a,e,t){"use strict";t.r(e);var r=t(42),n=Object(r.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("前端数据操作总结")]),a._v(" "),t("h3",{attrs:{id:"src转img"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#src转img"}},[a._v("#")]),a._v(" src转img")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function srctoimg(src){\n  return new Promise((reslove,reject)=>{\n    let img = new Image()\n    img.onload = function(){\n      reslove(img)\n    }\n    img.onerror = function(err) {\n      reject(err)\n    }\n    img.src = src\n  })\n}\n")])])]),t("h3",{attrs:{id:"img转canvas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#img转canvas"}},[a._v("#")]),a._v(" img转canvas")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function imgtocanvas(img){\n  let canvas = document.createElement(\"canvas\");\n  let ctx = canvas.getContext('2d')\n  canvas.width = img.width\n  canvas.height = img.height\n  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n  return canvas\n}\n")])])]),a._v(" "),t("h3",{attrs:{id:"imagedata转canvas"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#imagedata转canvas"}},[a._v("#")]),a._v(" ImageData转canvas")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function ImageDatetocanvas(imgData){\n let canvas = document.createElement(\"canvas\");\n let ctx = canvas.getContext('2d')\n canvas.width = imgData.width\n canvas.height = imgData.height\n ctx.putImageData(imgData,canvas.width, canvas.height);\n return canvas\n}\n")])])]),t("h3",{attrs:{id:"canvas转imagedata"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#canvas转imagedata"}},[a._v("#")]),a._v(" canvas转ImageData")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function canvastoImageDate(canvas){\n let ctx = canvas.getContext('2d')\n return ctx.createImageData(canvas.width,canvas.height)\n}\n")])])]),t("h3",{attrs:{id:"canvas像素操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#canvas像素操作"}},[a._v("#")]),a._v(" canvas像素操作")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function canvaspixel(canvas,deal) {\n  let ctx = canvas.getContext('2d')\n  var imgData = ctx.createImageData(canvas.width, canvas.height);\n  for (var i = 0; i < imgData.data.length; i += 4) {\n    deal(r,g,b,a)\n  }\n  ctx.putImageData(imgData, canvas.width, canvas.height);\n  return canvas\n}\n")])])]),t("h3",{attrs:{id:"canava转dataurl-base64"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#canava转dataurl-base64"}},[a._v("#")]),a._v(" canava转DataURL(base64)")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("canvas.toDataURL()\n")])])]),t("h3",{attrs:{id:"dataurl-base64-转blob"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dataurl-base64-转blob"}},[a._v("#")]),a._v(" DataURL(base64)转blob")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function dataURLtoBlob(dataurl) {\n  var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new Blob([u8arr], { type: mime });\n}\n")])])]),t("h3",{attrs:{id:"file转arraybuffer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file转arraybuffer"}},[a._v("#")]),a._v(" file转arrayBuffer")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function filetoblob(file){\n  return new Promise((resolve, reject) => {\n    var reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onload = function (e) {\n      resolve(reader.result)\n    }\n  })\n}\n")])])]),t("h3",{attrs:{id:"file转blob"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file转blob"}},[a._v("#")]),a._v(" file转blob")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function filetoblob(file){\n  return new Promise((resolve, reject) => {\n    var reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onload = function (e) {\n      resolve(new Blob([reader.result],{type:file.type}))\n    }\n  })\n}\n")])])]),t("h3",{attrs:{id:"blob-arraybuffer-转file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#blob-arraybuffer-转file"}},[a._v("#")]),a._v(" (blob,arraybuffer)转file")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function blobtofile(blob,name){\n    return new File([blob], name ,{type:blob.type})\n}\n")])])]),t("h3",{attrs:{id:"file-blob-转dataurl-base64"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file-blob-转dataurl-base64"}},[a._v("#")]),a._v(" file(blob)转DataURL(base64)")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function filetoblob(file) {\n  return new Promise((resolve, reject) => {\n    var reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = function (e) {\n      resolve(reader.result)\n    }\n    reader.onerror = function (e) {\n      resolve(reader.result)\n    }\n  })\n}\n")])])]),t("h3",{attrs:{id:"dataurl转file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dataurl转file"}},[a._v("#")]),a._v(" dataURL转File")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function dataURLtoFile(dataurl, filename) {\n    var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while(n--){\n        u8arr[n] = bstr.charCodeAt(n);\n    }\n    return new File([u8arr], filename, {type:mime});\n}\n")])])]),t("h3",{attrs:{id:"blob转objecturl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#blob转objecturl"}},[a._v("#")]),a._v(" blob转objectURL")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("window.URL.createObjectURL(blob)\n")])])]),t("h3",{attrs:{id:"objecturl转img"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#objecturl转img"}},[a._v("#")]),a._v(" objectURL转img")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("srctoimg(src)\n")])])]),t("h3",{attrs:{id:"objecturl-url-转blob"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#objecturl-url-转blob"}},[a._v("#")]),a._v(" objectURL(url)转blob")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function URLtoblob(){\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest()\n      xhr.open('GET', input)\n      xhr.responseType = 'blob'\n      xhr.onload = () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          resolve(xhr.response)\n        } else {\n          reject(xhr.statusText)\n        }\n      }\n      xhr.onerror = () => reject(xhr.statusText)\n      xhr.send()\n    })\n  }\n}\n")])])]),t("h3",{attrs:{id:"objecturl-url-转arraybuffer-当服务端传递二级制数据时使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#objecturl-url-转arraybuffer-当服务端传递二级制数据时使用"}},[a._v("#")]),a._v(" objectURL(url)转arraybuffer，当服务端传递二级制数据时使用")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function URLtoblob(){\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest()\n      xhr.open('GET', input)\n      xhr.responseType = 'arraybuffer'\n      xhr.onload = () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          resolve(xhr.response)\n        } else {\n          reject(xhr.statusText)\n        }\n      }\n      xhr.onerror = () => reject(xhr.statusText)\n      xhr.send()\n    })\n  }\n}\n")])])]),t("h3",{attrs:{id:"formdata设置blob"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#formdata设置blob"}},[a._v("#")]),a._v(" FormData设置blob")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('function appendBlob(blob){\n var fd = new FormData();\n fd.append("image", blob, "image.png");\n return fd\n}\n')])])]),t("h3",{attrs:{id:"uint8clampedarray-uint8array-区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uint8clampedarray-uint8array-区别"}},[a._v("#")]),a._v(" Uint8ClampedArray Uint8Array 区别")]),a._v(" "),t("h4",{attrs:{id:"uint8clampedarray"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uint8clampedarray"}},[a._v("#")]),a._v(" Uint8ClampedArray")]),a._v(" "),t("p",[a._v("1 ,它会将负数归入0，大于255的数归入255，所以取模就不用了。\n2 ,小数取整")]),a._v(" "),t("h4",{attrs:{id:"uint8array"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uint8array"}},[a._v("#")]),a._v(" Uint8Array")]),a._v(" "),t("p",[a._v("1,Uint8Array([-23]) 等价于 new Uint8Array([ 233 ])\n2,四舍五入\n在处理0-255无区别")]),a._v(" "),t("h4",{attrs:{id:"arraybuffer-视图-uint8array、float64array等-之slice"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#arraybuffer-视图-uint8array、float64array等-之slice"}},[a._v("#")]),a._v(" arraybuffer,视图(Uint8Array、Float64Array等)之slice")]),a._v(" "),t("p",[a._v("buf返回buf 视图返回视图 1,分配内存 2，拷贝数据\n数据\n1,new ArrayBuffer(40) 2,new Uint8Array( [ 1, 2, 3, 4 ] ) 3,Array.from(uint8Array);\n视图参数\nvar v3 = new Int16Array(buf, 2, 2); 第一个参数：视图对应的底层ArrayBuffer对象，该参数是必需的。 第二个参数：视图开始的字节序号，默认从0开始。 第三个参数：视图包含的数据个数，默认直到本段内存区域结束。\n视图.buffer 获取缓冲区\n视图对象DataView")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("var buffer = new ArrayBuffer(24);\nvar dv = new DataView(buffer);\n// 从第1个字节读取一个8位无符号整数\nvar v1 = dv.getUint8(0);\n// 从第2个字节读取一个16位无符号整数\nvar v2 = dv.getUint16(1); \n// 从第4个字节读取一个16位无符号整数\nvar v3 = dv.getUint16(3);\n\nsetInt8：写入1个字节的8位整数。\nsetUint8：写入1个字节的8位无符号整数。\nsetInt16：写入2个字节的16位整数。\nsetUint16：写入2个字节的16位无符号整数。\nsetInt32：写入4个字节的32位整数。\nsetUint32：写入4个字节的32位无符号整数。\nsetFloat32：写入4个字节的32位浮点数。\nsetFloat64：写入8个字节的64位浮点数。\n\n// 在第1个字节，以大端字节序写入值为25的32位整数\ndv.setInt32(0, 25, false); \n// 在第5个字节，以大端字节序写入值为25的32位整数\ndv.setInt32(4, 25); \n// 在第9个字节，以小端字节序写入值为2.5的32位浮点数\ndv.setFloat32(8, 2.5, true);\n")])])]),t("h3",{attrs:{id:"实现atob-base64-转-string-window-atob"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实现atob-base64-转-string-window-atob"}},[a._v("#")]),a._v(" 实现atob( base64 转 string) window.atob")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function _atob(s) {\n  var base64hash = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n  s = s.replace(/\\s|=/g, '');\n  var cur,\n    prev,\n    mod,\n    i = 0,\n    result = [];\n  while (i < s.length) {\n    cur = base64hash.indexOf(s.charAt(i));\n    mod = i % 4;\n    switch (mod) {\n      case 0:\n        //TODO\n        break;\n      case 1:\n        result.push(String.fromCharCode(prev << 2 | cur >> 4));\n        break;\n      case 2:\n        result.push(String.fromCharCode((prev & 0x0f) << 4 | cur >> 2));\n        break;\n      case 3:\n        result.push(String.fromCharCode((prev & 3) << 6 | cur));\n        break;\n    }\n    prev = cur;\n    i++;\n  }\n  return result.join('');\n}\n")])])]),t("h3",{attrs:{id:"实现btoa-string-转-base64-window-btoa"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实现btoa-string-转-base64-window-btoa"}},[a._v("#")]),a._v(" 实现btoa(string 转 base64) window.btoa")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("function _btoa(s) {\n  var base64hash = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n  if (/([^\\u0000-\\u00ff])/.test(s)) {\n    throw new Error('INVALID_CHARACTER_ERR');\n  }\n  var i = 0,\n    prev,\n    ascii,\n    mod,\n    result = [];\n  while (i < s.length) {\n    ascii = s.charCodeAt(i);\n    mod = i % 3;\n    switch (mod) {\n      // 第一个6位只需要让8位二进制右移两位\n      case 0:\n        result.push(base64hash.charAt(ascii >> 2));\n        break;\n      //第二个6位 = 第一个8位的后两位 + 第二个8位的前4位\n      case 1:\n        result.push(base64hash.charAt((prev & 3) << 4 | (ascii >> 4)));\n        break;\n      //第三个6位 = 第二个8位的后4位 + 第三个8位的前2位\n      //第4个6位 = 第三个8位的后6位\n      case 2:\n        result.push(base64hash.charAt((prev & 0x0f) << 2 | (ascii >> 6)));\n        result.push(base64hash.charAt(ascii & 0x3f));\n        break;\n    }\n    prev = ascii;\n    i++;\n  }\n  // 循环结束后看mod, 为0 证明需补3个6位，第一个为最后一个8位的最后两位后面补4个0。另外两个6位对应的是异常的“=”；\n  // mod为1，证明还需补两个6位，一个是最后一个8位的后4位补两个0，另一个对应异常的“=”\n  if (mod == 0) {\n    result.push(base64hash.charAt((prev & 3) << 4));\n    result.push('==');\n  } else if (mod == 1) {\n    result.push(base64hash.charAt((prev & 0x0f) << 2));\n    result.push('=');\n  }\n  return result.join('');\n}\n\n")])])]),t("h3",{attrs:{id:"atob-btoa-不能编码解码中文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#atob-btoa-不能编码解码中文"}},[a._v("#")]),a._v(" atob,btoa 不能编码解码中文")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('var str = "China，中国";\nwindow.btoa(window.encodeURIComponent(str))\n//"Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ="\nwindow.decodeURIComponent(window.atob(\'Q2hpbmElRUYlQkMlOEMlRTQlQjglQUQlRTUlOUIlQkQ=\'))\n//"China，中国"\n')])])]),t("p",[a._v("编码含义\n1，区分数据部分和参数部分\n2，解决中文乱码(服务端和客户端编码不一致)")]),a._v(" "),t("blockquote",[t("p",[a._v("escape不编码字符有69个："),t("em",[a._v("，+，-，.，/，@，_，0-9，a-z，A-Z\nencodeURI不编码字符有82个：!，#，$，&，'，(，)，")]),a._v("，+，,，-，.，/，:，;，=，?，@，"),t("em",[a._v("，~，0-9，a-z，A-Z\nencodeURIComponent不编码字符有71个：!， '，(，)，*，-，.，")]),a._v("，~，0-9，a-z，A-Z")])]),a._v(" "),t("p",[a._v("摘自https://juejin.im/post/5c00e8a66fb9a049db72dbd0#heading-22")])])}),[],!1,null,null,null);e.default=n.exports}}]);